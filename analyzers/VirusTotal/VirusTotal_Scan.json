{
  "name": "VirusTotal_Scan",
  "version": "3.0",
  "author": "CERT-BDF",
  "url": "https://github.com/CERT-BDF/Cortex-Analyzers",
  "license": "AGPL-V3",
  "description": "Use VirusTotal to scan a file or URL.",
  "dataTypeList": ["file", "url"],
  "baseConfig": "VirusTotal",
  "config": {
    "configurationItems": [
      {
        "name": "service",
        "description": "Service Name",
        "type": "string",
        "multi": false,
        "required": false,
        "defaultValue":  "scan"
      },
      {
        "name": "check_tlp",
        "description": "Define if the analyzer should check TLP of data before running",
        "type": "bool",
        "multi": false,
        "required": true,
        "defaultValue": false
      },
      {
        "name": "max_tlp",
        "description": "Define the maximum TLP level autorized",
        "type": "number",
        "multi": false,
        "required": true,
        "defaultValue": 1
      },
      {
        "name": "key",
        "description": "API key for Virustotal",
        "type": "string",
        "multi": false,
        "required": true,
        "defaultValue": "<API key>"
      },
      {
        "name": "polling_interval",
        "description": "Define time interval between two requests attempts for the report",
        "type": "number",
        "multi": false,
        "required": false,
        "defaultValue": 60
      }
    ]
  },
  "command": "VirusTotal/virustotal.py"
}
